{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Page</title>
    <link rel="stylesheet" href="{% static 'css/base/nav_bar.css' %}">
    <link rel="stylesheet" href="{% static 'css/base/footer.css' %}">
    <link rel="stylesheet" href="{% static 'css/categories/event_page.css' %}">
</head>
<body>

{% include 'base/nav_bar.html' %}

<main>
    <section class="upper-section">
        <h2>{{ object.title }}</h2>

        <div class="host">
            <a href="{% url 'profile-details-update' pk=object.host.profile.id %}" class="img-container">
                <img src="{{ object.host.profile.profile_image.url }}" alt="host-img">
            </a>

            <div class="more-info">
                <p>Hosted By</p>
                {% if request.user.profile.id == object.host.profile.id %}
                    <a href="{% url 'profile-details-update' pk=object.host.profile.id %}" class="host-name">You</a>
                {% else %}
                    <a href="{% url 'profile-details-update' pk=object.host.profile.id %}"
                       class="host-name">{{ object.host.profile.full_name }}</a>
                {% endif %}

            </div>
        </div>
    </section>

    <section class="info-section">
        <div class="left">
            {% if object.host.id == request.user.id and not object.passed_event %}
                <div>
                    <div class="buttons-container-edit-delete">
                        <a href="{% url 'edit-event' categoryId=object.category.id pk=object.id %}" class="edit-btn">Edit Event</a>
                        <a href="#" class="delete-btn">Delete Event</a>
                    </div>
                </div>
            {% elif object.host.id != request.user.id and not object.passed_event %}
                <div>
                    <div class="buttons-container-edit-delete">
                        {% if request.user.is_authenticated %}
                            {% if not user_favourite_event %}
                                <a class="save-to-favs-btn">Save Event to Favourites<img src="{% static 'images/star_icon.png' %}" alt="star-icon"></a>
                            {% else %}
                                <a class="save-to-favs-btn saved-to-favs">Saved Event to Favourites<img src="{% static 'images/done_icon.png' %}" alt="star-icon"></a>
                            {% endif %}
                        {% endif %}
                    </div>
                </div>
            {% else %}
                <p class="already-passed-event">This event has passed! Click here to see more: <a href="#explore">See more</a></p>
            {% endif %}

            <div class="event-img-container">
                <img src="{{ object.poster_image.url }}" alt="event_image">
            </div>

            <h4>Details</h4>

            <div class="text-info">
                <p>{{ object.details }}</p>
            </div>

            <div class="keywords-container">
                {% for keyword in keywords %}
                    <p>{{ keyword }}</p>
                {% endfor %}
            </div>

            <div class="comments-container">
                <div class="title-container">
                    <h3 id="comments-count">Comments ({{ count_comments }})</h3>

                    {% if event_comments %}
                        <a href="{% url 'all-events-page' %}">See all comments</a>
                    {% endif %}
                </div>

                <div class="all-comments">

                    {% for comment in event_comments %}
                        <div class="comment-container">
                            <div class="author">
                                <a href="{% url 'profile-details-update' pk=comment.user.profile.id %}" class="img-container">
                                    <img src="{{ comment.user.profile.profile_image.url }}" alt="host-img">
                                </a>

                                <div class="more-info">
                                    {% if request.user.id == comment.user.id %}
                                        <a href="{% url 'profile-details-update' pk=comment.user.profile.id %}" class="host-name">You</a>
                                    {% else %}
                                        <a href="{% url 'profile-details-update' pk=object.host.profile.id %}"
                                           class="host-name">{{ comment.user.profile.full_name }}</a>
                                    {% endif %}
                                </div>

                                {% if request.user.id == comment.user.id %}
                                    <div class="editing-icons">
                                        <img src="{% static 'images/edit_icon.png' %}" alt="edit-icon" class="edit-comment-icon {{ comment.id }}">
                                        <img src="{% static 'images/delete_icon.png' %}" alt="delete-icon" class="delete-comment-icon {{ comment.id }}">
                                    </div>
                                {% endif %}
                            </div>

                            <p class="comment-body">{{ comment.body }}</p>
                        </div>
                    {% empty %}
                        <div class="first-one">
                            <p class="first-to-comment-message">Be the first one to comment!</p>

                            {% if not request.user.is_authenticated %}
                                <a href="{% url 'login-user' %}" class="login-btn">Log In</a>
                            {% endif %}
                        </div>

                    {% endfor %}

                    {% if request.user.is_authenticated %}
                        <div class="send-comment-container">
                            <input type="text" id="add-new-comment" name="add-new-comment" placeholder="Add new comment..." >
                            <img src="{% static 'images/send_icon.png' %}" class="send-comment" alt="send-icon">
                        </div>

                        <ul class="errors-new-comment">

                        </ul>
                    {% endif %}

                </div>
            </div>
        </div>

        <div class="right {% if request.user in object.attendees.all %}attending{% endif %}">
            <div class="event-category">
                <div class="title-and-see-all">
                    <h4>Category</h4>
                </div>

                <a href="{% url 'category-page' pk=object.category.id %}"><img src="{{ object.category.image.url }}" alt="category-img">{{ object.category.name }}</a>
            </div>

            <div class="location-container">
                <div class="title-and-see-all">
                    <h4>More info</h4>
                </div>

                <section class="box">
                    <img src="{% static 'images/clock.png' %}" alt="clock_icon">
                    <p>{{ object.time }}</p>
                </section>

                <section class="box">
                    <img src="{% static 'images/location_grey.png' %}" alt="location_grey_icon">
                    <p>{{ object.exact_location }}</p>
                </section>
                <iframe src="https://www.google.com/maps?q={{ object.exact_location }}&output=embed&maptype=satellite"></iframe>
            </div>

            {% if request.user in object.attendees.all %}
                <p class="you-are-attending-message">You are attending this event!</p>
            {% endif %}

            <div class="buttons-container-attend">
                {% if request.user.is_authenticated and not event.host == request.user %}
                    {% if request.user in object.attendees.all %}
                        <button class="cancel-attendance">Cancel attendance</button>
                    {% else %}
                        <button class="attend">Attend</button>
                    {% endif %}
                {% endif %}

                <button class="share">Share <img src="{% static 'images/share.png' %}" alt="share-icon"></button>
            </div>
        </div>
    </section>

    {% if see_more_events %}
        <section class="upcoming-events" id="explore">
            <div class="title-container">
                <h3>See more ({{ count_more_events }})</h3>
                <a href="{% url 'all-events-page' %}">See all events</a>
            </div>

            <div class="events">
                {% for event in see_more_events %}
                    <a href="{% url 'event-page' categoryId=event.category.id pk=event.id %}" class="event-container">
                        <div class="img-container">
                            <img src="{{ event.poster_image.url }}" alt="event-img">
                        </div>

                        <div class="info">
                            <h6>{{ event.title }}</h6>

                            {% if event.host.id == request.user.id %}
                                <div class="your-event-container">
                                    <p>Your event</p>
                                    <img src="{% static 'images/your_event_icon.png' %}" alt="your-event-icon" >
                                </div>
                            {% endif %}

                            <p>Hosted by: {{ event.host.profile.full_name }}</p>
                            <p>{{ event.time }}</p>
                        </div>
                    </a>
                {% endfor %}
            </div>
        </section>
    {% endif %}
</main>

<div class="attending-cont">
    <div class="going-to-event-container">
        <h3>You are going!</h3>

        <section>
            <div class="left-img-container">
                <img src="{{ object.poster_image.url }}" alt="event-img">
            </div>

            <div class="right">
                <h5>{{ object.title }}</h5>

                <section class="box">
                    <img src="{% static 'images/clock.png' %}" alt="clock_icon">
                    <p>{{ object.time }}</p>
                </section>

                <section class="box">
                    <img src="{% static 'images/location_grey.png' %}" alt="location_grey_icon">
                    <p>{{ object.exact_location }}</p>
                </section>

                <section class="box">
                    <p class="reminder-message">You will receive a reminder email 1 day before the event!</p>
                </section>

                <button class="cancel">Cancel attending</button>
                <button class="share">Share <img src="{% static 'images/share_white.png' %}" alt="share-img"></button>
            </div>
        </section>
    </div>
</div>

<div class="cancel-attendance-cont">
    <div class="going-to-event-container">
        <h3>Are you sure you want to cancel your attendance?</h3>

        <section>
            <div class="left-img-container">
                <img src="{{ object.poster_image.url }}" alt="event-img">
            </div>

            <div class="right">
                <h5>{{ object.title }}</h5>

                <section class="box">
                    <img src="{% static 'images/clock.png' %}" alt="clock_icon">
                    <p>{{ object.time }}</p>
                </section>

                <section class="box">
                    <img src="{% static 'images/location_grey.png' %}" alt="location_grey_icon">
                    <p>{{ object.exact_location }}</p>
                </section>

                <button class="cancel">Yes, cancel my attendance!</button>
                <button class="share">Share <img src="{% static 'images/share_white.png' %}" alt="share-img"></button>
            </div>
        </section>
    </div>
</div>

<div class="delete-event-cont">
    <form method="POST">
        {% csrf_token %}

        <h3>Are you sure you want to delete this event?</h3>

        <section>
            <div class="left-img-container">
                <img src="{{ object.poster_image.url }}" alt="event-img">
            </div>

            <div class="right">
                <h5>{{ object.title }}</h5>

                <section class="box">
                    <img src="{% static 'images/clock.png' %}" alt="clock_icon">
                    <p>{{ object.time }}</p>
                </section>

                <section class="box">
                    <img src="{% static 'images/location_grey.png' %}" alt="location_grey_icon">
                    <p>{{ object.exact_location }}</p>
                </section>

                <button type="submit" class="delete-event-btn">Confirm</button>
                <button type="button" class="cancel-deleting-btn">Cancel</button>
            </div>
        </section>
    </form>
</div>

{% include 'base/footer.html' %}

</body>

<script src="{% static 'js/nav_bar.js' %}"
        lightLogo="{% static 'images/volunteer_act_logo_light.png' %}"
        darkLogo="{% static 'images/volunteer_act_logo_dark.png' %}"
></script>

<script>

    const attendEventBtn = document.getElementsByClassName('attend')[0]
    const attendingEventContainer = document.querySelectorAll('.attending-cont .going-to-event-container')[0]
    const mainElement = document.getElementsByTagName('main')[0]

    if (attendEventBtn) {
        attendEventBtn.addEventListener('click', () => {
            attendingEventContainer.style.display = 'flex'
            mainElement.style.opacity = '0.4'
            mainElement.style.filter = 'alpha(opacity=20)'
        })
    }





    const cancelAttendanceBtn = document.getElementsByClassName('cancel-attendance')[0]
    const cancelAttendanceContainer = document.querySelectorAll('.cancel-attendance-cont .going-to-event-container')[0]

    if (cancelAttendanceBtn) {
        cancelAttendanceBtn.addEventListener('click', () => {
            cancelAttendanceContainer.style.display = 'flex'
            mainElement.style.opacity = '0.4'
            mainElement.style.filter = 'alpha(opacity=20)'
        })
    }


    const cancelAttendance = document.querySelector('.cancel-attendance-cont .cancel')
    const eventUpdateURL = `{% url 'update-event-api' pk='0' %}`.replace('0', {{ object.id }})
    const currentLoggedInUserId = `{{ request.user.id }}`

    if (cancelAttendance) {

        cancelAttendance.addEventListener('click', () => {
            let attendees = []

            const response = fetch(eventUpdateURL)
                .then((response) => response.json())
                .then((resultEvent) => {
                    attendees = resultEvent.attendees.filter(attendee => `${attendee}` !== currentLoggedInUserId)

                    const updateResponse = fetch(eventUpdateURL, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': `{{ csrf_token }}`
                        },
                        body: JSON.stringify({
                            ...resultEvent,
                            attendees
                        })
                    })

                })

            location.reload()
        })

    }





    const deleteEventBtn = document.getElementsByClassName('delete-btn')[0]
    const deleteEventContainerForm = document.querySelectorAll('.delete-event-cont form')[0]

    if (deleteEventBtn) {
        deleteEventBtn.addEventListener('click', () => {
            deleteEventContainerForm.style.display = 'flex'
            mainElement.style.opacity = '0.4'
            mainElement.style.filter = 'alpha(opacity=20)'
        })

        const cancelDeletingBtn = document.getElementsByClassName('cancel-deleting-btn')[0]

        cancelDeletingBtn.addEventListener('click', () => {
            deleteEventContainerForm.style.display = 'none'
            mainElement.style.opacity = '1'
            mainElement.style.filter = 'alpha(opacity=100)'
        })
    }








    const saveToFavsEventBtn = document.getElementsByClassName('save-to-favs-btn')[0]

    if (saveToFavsEventBtn) {
        saveToFavsEventBtn.addEventListener('click', () => {

            const saveToFavsRequest = async() => {
                const response = fetch('{% url 'list-create-favourites-record-api' %}', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': `{{ csrf_token }}`
                    },
                    body: JSON.stringify({
                        user: `{{ request.user.id }}`,
                        event: `{{ object.id }}`
                    })
                })
                    .then((response) => response.json())
                    .then((result) => {
                        const imgElement = document.createElement('img')
                        imgElement.src = `{% static 'images/done_icon.png' %}`

                        saveToFavsEventBtn.textContent = 'Saved Event to Favourites'
                        saveToFavsEventBtn.appendChild(imgElement)

                        saveToFavsEventBtn.addEventListener('mouseover', () => {
                            saveToFavsEventBtn.style.backgroundColor = 'rgba(53, 191, 237, 0.18)'
                            saveToFavsEventBtn.style.cursor = 'auto'
                        })
                    })
            }

            saveToFavsRequest()
        })
    }









    const sendCommentElement = document.getElementsByClassName('send-comment')[0]
    const addNewCommentInput = document.getElementById('add-new-comment')
    const commentsContainer = document.getElementsByClassName('all-comments')[0]
    const commentsCountElement = document.getElementById('comments-count')
    const allCommentContainers = document.getElementsByClassName('comment-container')
    const beTheFirstOneToCommentMessage = document.getElementsByClassName('first-to-comment-message')[0]

    if (sendCommentElement) {
        sendCommentElement.addEventListener('click', () => {

            const addNewCommentRequest = async() => {
                const response = fetch('{% url 'list-create-comments-api' %}', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': `{{ csrf_token }}`
                    },
                    body: JSON.stringify({
                        body: addNewCommentInput.value,
                        event: `{{ object.id }}`,
                        user: `{{ request.user.id }}`,
                    })
                })
                    .then((response) => response.json())
                    .then((result) => {
                        const ulErrorsNewComment = document.getElementsByClassName('errors-new-comment')[0]

                        if (typeof result.body !== "string") {
                            for (let error of result.body) {

                                if (!ulErrorsNewComment.textContent.includes(error)) {
                                    const liErrorEl = document.createElement('li')
                                    liErrorEl.textContent = error

                                    ulErrorsNewComment.appendChild(liErrorEl)
                                }
                            }
                        } else {

                            addNewCommentInput.value = ''

                            const createdCommentUrl = `{% url 'details-comment-api' pk='0' %}`.replace('0', result.id)

                            const createdCommentWholeDetails = fetch(createdCommentUrl)
                                .then((response2) => response2.json())
                                .then((commentResult) => {
                                    ulErrorsNewComment.innerHTML = ''

                                    const newCommentContainer = document.createElement('div')
                                    newCommentContainer.className = 'comment-container'

                                    const profileURL = `{% url 'profile-details-update' pk='0' %}`.replace('0', commentResult.user.profile.id)
                                    const requestUserId = `{{ request.user.id }}`

                                    const editCommentIconClass = `edit-comment-icon ${commentResult.id}`
                                    const deleteCommentIconClass = `delete-comment-icon ${commentResult.id}`

                                    if (requestUserId == `${commentResult.user.id}`) {
                                        newCommentContainer.innerHTML = `
                                            <div class="author">
                                                <a href="${profileURL}" class="img-container">
                                                    <img src="${commentResult.profile_image_full_url}" alt="host-img">
                                                </a>

                                                <div class="more-info">
                                                    <a href="${profileURL}" class="host-name">You</a>
                                                </div>

                                                <div class="editing-icons">
                                                    <img src="{% static 'images/edit_icon.png' %}" alt="edit-icon" class="${editCommentIconClass}">
                                                    <img src="{% static 'images/delete_icon.png' %}" alt="delete-icon" class="${deleteCommentIconClass}">
                                                </div>
                                            </div>

                                            <p class="comment-body">${commentResult.body}</p>
                                        `
                                    } else {
                                        newCommentContainer.innerHTML = `
                                            <div class="author">
                                                <a href="${profileURL}" class="img-container">
                                                    <img src="${commentResult.profile_image_full_url}" alt="host-img">
                                                </a>

                                                <div class="more-info">
                                                    <a href="${profileURL}" class="host-name">${commentResult.user.profile.full_name}</a>
                                                </div>
                                            </div>

                                            <p class="comment-body">${commentResult.body}</p>
                                        `
                                    }

                                    commentsContainer.prepend(newCommentContainer)
                                    const lastCommentContainerNumber = commentsContainer.getElementsByClassName('comment-container').length - 1

                                    if (lastCommentContainerNumber > 2) {
                                        commentsContainer.getElementsByClassName('comment-container')[lastCommentContainerNumber].remove()
                                    }

                                    editingComments()
                                    deletingComments()

                                    if (beTheFirstOneToCommentMessage) {
                                        beTheFirstOneToCommentMessage.style.display = 'none'
                                    }

                                    if (commentsCountElement.textContent.includes('0')) {
                                        commentsCountElement.textContent = 'Comments (1)'
                                    } else if (commentsCountElement.textContent.includes('1')) {
                                        commentsCountElement.textContent = 'Comments (2)'
                                    } else if (commentsCountElement.textContent.includes('2')) {
                                        commentsCountElement.textContent = 'Comments (3)'
                                    } else {
                                        commentsCountElement.textContent = 'Comments (3+)'
                                    }
                                })

                            }

                    })
            }

            addNewCommentRequest()

        })
    }





    const attendBtn = document.getElementsByClassName('attend')[0]

    if (attendBtn) {

        attendBtn.addEventListener('click', () => {
            let currentAttendees = []

            const response = fetch(eventUpdateURL)
                .then((response) => response.json())
                .then((resultEvent) => {
                    currentAttendees = resultEvent.attendees
                    currentAttendees.push({{ request.user.id }})

                    const updateResponse = fetch(eventUpdateURL, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': `{{ csrf_token }}`
                        },
                        body: JSON.stringify({
                            ...resultEvent,
                            attendees: currentAttendees
                        })

                    })
                })


        })

    }







    function editingComments() {
        const editIconBtns = document.getElementsByClassName('edit-comment-icon')

        for (let editIcon of editIconBtns) {
            const commentId = editIcon.classList[1]
            const commentContainer = editIcon.parentElement.parentElement.parentElement
            const commentBody = editIcon.parentElement.parentElement.parentElement.getElementsByClassName('comment-body')[0]
            const inputEditComment = document.createElement('input')
            inputEditComment.value = commentBody.textContent
            inputEditComment.className = 'edit-comment-input'
            const saveEditedCommentBtn = document.createElement('button')
            saveEditedCommentBtn.textContent = 'Save'
            saveEditedCommentBtn.className = 'save-edited-btn'
            const cancelEditBtn = document.createElement('button')
            cancelEditBtn.textContent = 'Cancel'
            cancelEditBtn.className = 'cancel-edit-btn'

            const buttonsContainer = document.createElement('div')
            buttonsContainer.className = 'comment-buttons-container'
            buttonsContainer.appendChild(saveEditedCommentBtn)
            buttonsContainer.appendChild(cancelEditBtn)

            editIcon.addEventListener('click', () => {
                const commentBody = editIcon.parentElement.parentElement.parentElement.getElementsByClassName('comment-body')[0]
                inputEditComment.value = commentBody.textContent

                commentContainer.removeChild(commentBody)
                commentContainer.appendChild(inputEditComment)
                commentContainer.appendChild(buttonsContainer)
            })

            saveEditedCommentBtn.addEventListener('click', () => {
                const newEditedComment = inputEditComment.value
                const editCommentUrl = `{% url 'edit-delete-comment-api' pk='0' %}`.replace('0', commentId)

                fetch(editCommentUrl, {
                    method: 'PATCH',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': '{{ csrf_token }}'
                    },
                    body: JSON.stringify({
                        body: newEditedComment
                    })
                })
                    .then((response) => response.json())
                    .then((resultEditedComment) => {
                        if (typeof resultEditedComment.body !== 'string') {
                            const ulErrorsEditedComment = document.createElement('ul')
                            ulErrorsEditedComment.className = 'errors-edited-comment'
                            inputEditComment.after(ulErrorsEditedComment)

                            for (let error of resultEditedComment.body) {
                                if (!ulErrorsEditedComment.textContent.includes(error)) {
                                    const liErrorEl = document.createElement('li')
                                    liErrorEl.textContent = error

                                    ulErrorsEditedComment.appendChild(liErrorEl)
                                }
                            }
                        } else {
                            commentContainer.removeChild(inputEditComment)
                            commentContainer.removeChild(buttonsContainer)

                            const ulErrors = commentContainer.getElementsByClassName('errors-edited-comment')[0]

                            if (ulErrors) {
                                ulErrors.remove()
                            }

                            const pCommentBody = document.createElement('p')
                            pCommentBody.className = 'comment-body'
                            pCommentBody.textContent = resultEditedComment.body

                            commentContainer.appendChild(pCommentBody)
                        }

                    })
            })

            cancelEditBtn.addEventListener('click', () => {
                const pCommentBody = document.createElement('p')
                pCommentBody.className = 'comment-body'
                pCommentBody.textContent = commentBody.textContent

                const ulErrorsEditedComment = commentContainer.getElementsByClassName('errors-edited-comment')[0]
                if (ulErrorsEditedComment) {
                    ulErrorsEditedComment.remove()
                }

                commentContainer.removeChild(inputEditComment)
                commentContainer.removeChild(buttonsContainer)

                commentContainer.appendChild(pCommentBody)
            })
        }
    }

    editingComments()






    function deletingComments() {
        const deleteCommentBtns = document.getElementsByClassName('delete-comment-icon')

        for (let deleteIcon of deleteCommentBtns) {
            const commentId = deleteIcon.classList[1]
            const commentContainer = deleteIcon.parentElement.parentElement.parentElement
            const pConfirmingElement = document.createElement('p')
            pConfirmingElement.className = 'confirm-deleting-comment'
            pConfirmingElement.textContent = 'Are you sure you want to delete this comment?'
            const confirmDeletingCommentBtn = document.createElement('button')
            confirmDeletingCommentBtn.textContent = 'Confirm'
            confirmDeletingCommentBtn.className = 'save-edited-btn'
            const cancelDeletingCommentBtn = document.createElement('button')
            cancelDeletingCommentBtn.textContent = 'Cancel'
            cancelDeletingCommentBtn.className = 'cancel-edit-btn'

            const buttonsContainer = document.createElement('div')
            buttonsContainer.className = 'comment-buttons-container'
            buttonsContainer.appendChild(confirmDeletingCommentBtn)
            buttonsContainer.appendChild(cancelDeletingCommentBtn)

            deleteIcon.addEventListener('click', () => {
                commentContainer.appendChild(pConfirmingElement)
                commentContainer.appendChild(buttonsContainer)
            })

            confirmDeletingCommentBtn.addEventListener('click', () => {
                const deleteCommentUrl = `{% url 'edit-delete-comment-api' pk='0' %}`.replace('0', commentId)

                fetch(deleteCommentUrl, {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': `{{ csrf_token }}`
                    }
                })
                    .then((response) => response.json())
                    .then((result) => {
                        const firstThreeComments = fetch(`{% url 'list-create-comments-api' %}`)
                            .then((response) => response.json())
                            .then((resultComments) => {
                                const firstThreeComments = resultComments.slice(0, 3)
                                const allCommentsContainer = document.getElementsByClassName('all-comments')[0]
                                allCommentsContainer.innerHTML = ''

                                for (let comment of firstThreeComments) {
                                    const newCommentContainer = document.createElement('div')
                                    newCommentContainer.className = 'comment-container'

                                    const profileURL = `{% url 'profile-details-update' pk='0' %}`.replace('0', comment.user.profile.id)
                                    const requestUserId = `{{ request.user.id }}`

                                    if (requestUserId == `${comment.user.id}`) {
                                        newCommentContainer.innerHTML = `
                                            <div class="author">
                                                <a href="${profileURL}" class="img-container">
                                                    <img src="${comment.profile_image_full_url}" alt="host-img">
                                                </a>

                                                <div class="more-info">
                                                    <a href="${profileURL}" class="host-name">You</a>
                                                </div>

                                                <div class="editing-icons">
                                                    <img src="{% static 'images/edit_icon.png' %}" alt="edit-icon" class="edit-comment-icon {{ comment.id }}">
                                                    <img src="{% static 'images/delete_icon.png' %}" alt="delete-icon" class="delete-comment-icon {{ comment.id }}">
                                                </div>
                                            </div>

                                            <p>${comment.body}</p>
                                        `

                                        {#editingComments()#}
                                    } else {
                                        newCommentContainer.innerHTML = `
                                            <div class="author">
                                                <a href="${profileURL}" class="img-container">
                                                    <img src="${commentResult.profile_image_full_url}" alt="host-img">
                                                </a>

                                                <div class="more-info">
                                                    <a href="${profileURL}" class="host-name">${commentResult.user.profile.full_name}</a>
                                                </div>
                                            </div>

                                            <p>${commentResult.body}</p>
                                        `
                                    }

                                    allCommentsContainer.appendChild(newCommentContainer)
                                }

                            })
                    })

                commentContainer.remove()


            })

            cancelDeletingCommentBtn.addEventListener('click', () => {
                commentContainer.removeChild(pConfirmingElement)
                commentContainer.removeChild(buttonsContainer)
            })
        }
    }

    deletingComments()

</script>
</html>